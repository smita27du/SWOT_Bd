<html>

<!--- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
 // Timeseries plotting of Basin average parameters
 // Written by Nishan Kumar Biswas
 // PhD Student and Graduate Research Assistant
 // Department of CEE, University of Washington
 // nbiswas@uw.edu, nishan.wre.buet@gmail.com
 // www.students.washington.edu/nbiswas

-->

<head>
<script type="text/javascript" src="js/jquery.min.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/highcharts-more.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script>
    function getParamValue(paramName) {
        var url = window.location.search.substring(1); //get rid of "?" in querystring
        var qArray = url.split('&'); //get key-value pairs
        for (var i = 0; i < qArray.length; i++) {
            var pArr = qArray[i].split('='); //split key and value
            if (pArr[0] == paramName)
                return pArr[1]; //return value
        }
    }
	function zfill(num, len) {
	return (Array(len).join("0") + num).slice(-len);}
</script>


<script type="text/javascript">
 var swot_station = getParamValue("stationid");
 var bwdb_stid = getParamValue("bwdbid");

function retrieveswot()
{
	dataset = '';
	// AJAX in the data file
    $.ajax({
        type: "GET",
        url: "data/swot_wse/" + swot_station  + ".csv",
		async: false,
        dataType: "text",
        success: function(data)
		{
		  dataset=String(data);
		}
        });
		return dataset;
}

function retrievebwdb()
{
	dataset = '';
	// AJAX in the data file
    $.ajax({
        type: "GET",
        url: "data/bwdb_measured_daily.csv",
		async: false,
        dataType: "text",
        success: function(data)
		{
		  dataset=String(data);
		}
        });
		return dataset;
}


function load()
{
	var rmsardata = [],
	kmeansdata = [];

	
	gfsdata = retrieveswot();
	lines = gfsdata.split('\n');
	for (i = 1; i < lines.length; i++) {
	var items = lines[i].split(',');
		rmsardata.push([new Date(items[0]).getTime(), +items[2]]);
	}

	ecmwfdata = retrievebwdb();
	lines = ecmwfdata.split('\n');
	for (i = 1; i < lines.length; i++) {
	var items = lines[i].split(',');
		if (items[0] == bwdb_stid){
		kmeansdata.push([new Date(items[1]).getTime(), +items[2]]);
		}
	}
        Highcharts.setOptions({
           global: {
              useUTC: false
           }
        });
	var chart = Highcharts.chart('container', {
	chart: {
			zoomType: 'x',
			panning: true,
			panKey: 'shift'
		},
	title: {
	  text: "SWOT \and BWDB WL Comparison"
	},
	subtitle: {
	  text: "SWOT Reach ID: " + swot_station + ", BWDB Station ID: " + bwdb_stid
	},
	xAxis: {
	  type: 'datetime'
	},
	yAxis: {
	  title: {
		text: 'Water Height (m)'
	  },
	  labels: {
        format: '{value:.2f}'
	  },
	  minTickInterval: 0.01
	},
	tooltip: {
		xDateFormat: '%d-%m-%Y',
	  crosshairs: true,
	  shared: true,
	  valueSuffix: " m"
	},
	legend: {},
	series: [{
	  name: 'BWDB Measured River Height',
	  data: kmeansdata,
	  type: 'spline',
	  marker: {
		enabled: false,
		radius: 3		
	  },
	  color:'blue',
	  zIndex: 1,
	  states: {
		hover: {			
		  lineWidthPlus: 0
		}
	  }
	},{
	  name: 'SWOT Satellite derived River Height',
	  data: rmsardata,
	  type: 'spline',
		marker: {
			enabled: true,
			radius: 4
		},
	  color:'red',
	  zIndex: 1,
		states: {
			hover: {
				lineWidthPlus: 0
			}
		}
	}]
	});

}
</script>
<style>
.selector {
	position: absolute;
	right: 20px;
	top: 368px;
}
.errormessage {
	position: absolute;
	width:200px;
	left:50%;
	margin-left:-100px;
	top: 60px;
    color: red;
    padding: 20px;
    font-size: 20px;
    border: 2px;
    cursor: pointer;
}
.selectyear {
    background-color: #444244;
    color: white;
    padding: 10px;
    font-size: 16px;
    border: 2px;
    cursor: pointer;
}

</style>
</head>
<body onload="load()">
<div id="container" style="width: 100%; height: 400px; margin: 0 auto"></div>
</body>
